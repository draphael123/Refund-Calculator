<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Process accurate refunds for patients who are due them. Calculate refund amounts for assessment fees, expanded labs, Getlabs fees, and subscription fees.">
    <meta name="keywords" content="refund calculator, patient refunds, healthcare refunds, refund converter, assessment fee refunds">
    <meta name="author" content="Refund Converter">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="Refund Converter - Accurate Patient Refund Calculator">
    <meta property="og:description" content="Process accurate refunds for patients who are due them. Calculate refund amounts quickly and easily.">
    <meta property="og:url" content="https://refund-calculator-3jaa1o9z4-daniel-8982s-projects.vercel.app">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:title" content="Refund Converter - Accurate Patient Refund Calculator">
    <meta property="twitter:description" content="Process accurate refunds for patients who are due them. Calculate refund amounts quickly and easily.">
    
    <title>Refund Converter - Accurate Patient Refund Calculator</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üíä</text></svg>">
</head>
<body>
    <div class="theme-toggle-container">
        <button id="themeToggle" class="theme-toggle" aria-label="Toggle dark mode">
            <span class="theme-icon">üåô</span>
        </button>
    </div>
    
    <div class="container">
        <div class="calculator-card">
            <h1>Refund Converter</h1>
            <p class="subtitle">Process accurate refunds for patients who are due them</p>
            
            <div class="refund-notice">
                <div class="refund-notice-icon">‚ÑπÔ∏è</div>
                <div class="refund-notice-content">
                    <strong>Refund Eligibility:</strong>
                    <ul>
                        <li><strong>Assessment Fees:</strong> Patients can always get refunds for their assessment fee</li>
                        <li><strong>Expanded Labs, Getlabs Fees, and Subscription Fees:</strong> Refunds are more complicated and depend on specific circumstances</li>
                    </ul>
                </div>
            </div>
            
            <div class="instructions-section">
                <button type="button" class="instructions-toggle" id="instructionsToggle" aria-expanded="false" aria-controls="instructionsContent">
                    <span class="instructions-icon">üìñ</span>
                    <span class="instructions-toggle-text">Show Instructions</span>
                    <span class="instructions-arrow">‚ñº</span>
                </button>
                <div class="instructions-content" id="instructionsContent">
                    <div class="instructions-body">
                        <h3>How to Use</h3>
                        <ol>
                            <li><strong>Enter the Amount Paid:</strong> Enter the total amount paid (e.g., 100.00).</li>
                            <li><strong>Enter Medication/Service Dispensed:</strong> Enter the amount of medication or service received. You can include units (e.g., "100mg", "50ml") or just the number (e.g., "100"). The calculator will automatically detect the amount.</li>
                            <li><strong>Enter Weeks Paid:</strong> Enter the number of weeks you paid for (e.g., "12" or "12 weeks").</li>
                            <li><strong>Enter Weeks Received:</strong> Enter the number of weeks of medication/service you actually received. If you received the full amount, enter the same as "Weeks Paid".</li>
                            <li><strong>Click Calculate:</strong> Click the "Calculate" button to see your results, including the refund amount.</li>
                        </ol>
                        
                        <h3>Using the Medication List</h3>
                        <p>You can also select medications from the predefined list below the main form:</p>
                        <ul>
                            <li>Click "Add Medication" to select from the list of available medications</li>
                            <li>After selecting a medication, you'll see the pre-filled details</li>
                            <li>Adjust the "Weeks Received" field for each medication to calculate refunds</li>
                            <li>You can add multiple medications and see a total refund amount</li>
                        </ul>
                        
                        <h3>How Refunds Are Calculated</h3>
                        <div class="formula-box">
                            <strong>Refund Formula:</strong>
                            <div class="formula">Refund = (Weeks Paid - Weeks Received) √ó Cost per Week</div>
                            <p><em>Note: If weeks received is equal to or greater than weeks paid, the refund will be $0.00 (full medication received).</em></p>
                        </div>
                        
                        <h3>Understanding the Results</h3>
                        <ul>
                            <li><strong>Cost per Week:</strong> The amount you paid divided by the number of weeks</li>
                            <li><strong>Cost per Unit:</strong> The amount you paid divided by the medication amount</li>
                            <li><strong>Medication per Week:</strong> How much medication you receive each week</li>
                            <li><strong>Weekly Cost per Unit:</strong> The cost per unit per week</li>
                            <li><strong>Refund Amount:</strong> The amount you should receive back if you didn't receive the full medication supply</li>
                        </ul>
                        
                        <h3>Keyboard Shortcuts</h3>
                        <ul>
                            <li><kbd>Enter</kbd> - Submit the form (when all fields are valid)</li>
                            <li><kbd>Esc</kbd> - Clear focus from current input field</li>
                        </ul>
                        
                        <h3>Tips</h3>
                        <ul>
                            <li>You can use formats like "4 weeks", "4w", or just "4" for week fields</li>
                            <li>The calculator remembers your recent calculations - check the history section below</li>
                            <li>Use the medication dropdown to quickly select from common medications</li>
                            <li>Click the tooltip icons (‚ÑπÔ∏è) next to each field for additional help</li>
                            <li>Results can be copied, printed, or shared using the action buttons</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <form id="calculatorForm" novalidate>
                <div class="input-group">
                    <label for="amountPaid">
                        Amount Paid ($)
                        <span class="tooltip-icon" data-tooltip="Enter the total amount the patient has paid for the medication">‚ÑπÔ∏è</span>
                    </label>
                    <input 
                        type="number" 
                        id="amountPaid" 
                        name="amountPaid" 
                        step="0.01" 
                        min="0" 
                        placeholder="Enter amount paid"
                        required
                        aria-describedby="amountPaid-error"
                        aria-invalid="false"
                    >
                    <span class="error-message" id="amountPaid-error" role="alert"></span>
                    <span class="validation-icon"></span>
                </div>
                
                <div class="input-group">
                    <label for="medicationDispensed">
                        Amount of Medication Dispensed
                        <span class="tooltip-icon" data-tooltip="Enter the medication amount (e.g., 100mg, 50ml, or just 100). Supports unit conversion.">‚ÑπÔ∏è</span>
                    </label>
                    <div class="input-with-unit">
                        <input 
                            type="text" 
                            id="medicationDispensed" 
                            name="medicationDispensed" 
                            placeholder="Enter medication amount (e.g., 100mg or 100)"
                            required
                            aria-describedby="medicationDispensed-error"
                            aria-invalid="false"
                        >
                        <select id="medicationUnit" aria-label="Medication unit">
                            <option value="">Auto</option>
                            <option value="mg">mg</option>
                            <option value="g">g</option>
                            <option value="ml">ml</option>
                            <option value="l">L</option>
                            <option value="units">units</option>
                        </select>
                    </div>
                    <span class="error-message" id="medicationDispensed-error" role="alert"></span>
                    <span class="validation-icon"></span>
                </div>
                
                <div class="input-group">
                    <label for="weeksPaid">
                        Number of Weeks Paid
                        <span class="tooltip-icon" data-tooltip="Enter the number of weeks the patient paid for (e.g., 4 weeks or 4)">‚ÑπÔ∏è</span>
                    </label>
                    <input 
                        type="text" 
                        id="weeksPaid" 
                        name="weeksPaid" 
                        placeholder="Enter number of weeks (e.g., 4 weeks or 4)"
                        required
                        aria-describedby="weeksPaid-error"
                        aria-invalid="false"
                    >
                    <span class="error-message" id="weeksPaid-error" role="alert"></span>
                    <span class="validation-icon"></span>
                </div>
                
                <div class="input-group">
                    <label for="weeksReceived">
                        Number of Weeks Received
                        <span class="tooltip-icon" data-tooltip="Enter the number of weeks of medication actually received. If full amount received, enter same as weeks paid.">‚ÑπÔ∏è</span>
                    </label>
                    <input 
                        type="text" 
                        id="weeksReceived" 
                        name="weeksReceived" 
                        placeholder="Enter weeks received (e.g., 4 weeks or 4)"
                        required
                        aria-describedby="weeksReceived-error"
                        aria-invalid="false"
                    >
                    <span class="error-message" id="weeksReceived-error" role="alert"></span>
                    <span class="validation-icon"></span>
                </div>
                
                <div class="medications-section">
                    <div class="section-header">
                        <label>
                            Medications from Spreadsheet
                            <span class="tooltip-icon" data-tooltip="Select medications from the spreadsheet to calculate refunds. Click + to add multiple medications.">‚ÑπÔ∏è</span>
                        </label>
                    </div>
                    <div id="medicationsList" class="medications-list">
                        <div class="medication-item" data-medication-index="0">
                            <div class="medication-selector">
                                <select class="medication-dropdown" data-index="0" aria-label="Select medication">
                                    <option value="">-- Select Medication --</option>
                                </select>
                                <button type="button" class="remove-medication-btn" data-index="0" aria-label="Remove medication" style="display: none;">
                                    <span>üóëÔ∏è</span>
                                </button>
                            </div>
                            <div class="medication-details hidden" data-details-index="0">
                                <div class="medication-info">
                                    <div class="info-row">
                                        <span class="info-label">Amount Paid:</span>
                                        <span class="info-value" data-field="amountPaid">$0.00</span>
                                    </div>
                                    <div class="info-row">
                                        <span class="info-label">Medication Dispensed:</span>
                                        <span class="info-value" data-field="medicationDispensed">0</span>
                                    </div>
                                    <div class="info-row">
                                        <span class="info-label">Weeks Paid:</span>
                                        <span class="info-value" data-field="weeksPaid">0</span>
                                    </div>
                                    <div class="info-row">
                                        <span class="info-label">Weeks Received:</span>
                                        <span class="info-value" data-field="weeksReceived">0</span>
                                    </div>
                                    <div class="info-row highlight">
                                        <span class="info-label">Refund:</span>
                                        <span class="info-value" data-field="refund">$0.00</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="add-medication-btn" id="addMedicationBtn" aria-label="Add another medication">
                        <span>‚ûï</span> Add Medication
                    </button>
                </div>
                
                <div class="button-group">
                    <button type="submit" class="calculate-btn" id="calculateBtn">
                        <span class="btn-text">Calculate</span>
                        <span class="btn-loader hidden"></span>
                    </button>
                    <button type="button" class="clear-btn" id="clearBtn">Clear</button>
                    <button type="button" class="demo-btn" id="demoBtn">
                        <span>üí°</span> Try Example
                    </button>
                </div>
            </form>
            
            <div id="results" class="results hidden">
                <div class="results-header">
                    <h2>Calculation Results</h2>
                    <div class="results-actions">
                        <button class="action-btn" id="copyBtn" aria-label="Copy results">
                            <span>üìã</span> Copy
                        </button>
                        <button class="action-btn" id="printBtn" aria-label="Print results">
                            <span>üñ®Ô∏è</span> Print
                        </button>
                        <button class="action-btn" id="shareBtn" aria-label="Share results">
                            <span>üîó</span> Share
                        </button>
                    </div>
                </div>
                
                <div class="results-content">
                    <div class="result-item refund-summary-item" id="mainRefundItem" style="display: none;">
                        <span class="result-label">Refund Amount:</span>
                        <span class="result-value" id="mainRefundAmount">$0.00</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Cost per Week:</span>
                        <span class="result-value" id="costPerWeek">$0.00</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Cost per Unit of Medication:</span>
                        <span class="result-value" id="costPerUnit">$0.00</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Medication per Week:</span>
                        <span class="result-value" id="medicationPerWeek">0.00</span>
                    </div>
                    <div class="result-item highlight">
                        <span class="result-label">Total Weekly Cost per Unit:</span>
                        <span class="result-value" id="weeklyCostPerUnit">$0.00</span>
                    </div>
                    <div class="result-item refund-summary-item" id="totalRefundItem" style="display: none;">
                        <span class="result-label">Total Intended Refund:</span>
                        <span class="result-value" id="totalIntendedRefund">$0.00</span>
                    </div>
                    
                    <div class="additional-calculations">
                        <h3>Projections</h3>
                        <div class="result-item">
                            <span class="result-label">Cost for 1 Month (4 weeks):</span>
                            <span class="result-value" id="costOneMonth">$0.00</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">Cost for 3 Months (12 weeks):</span>
                            <span class="result-value" id="costThreeMonths">$0.00</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">Cost for 6 Months (24 weeks):</span>
                            <span class="result-value" id="costSixMonths">$0.00</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">Cost for 1 Year (52 weeks):</span>
                            <span class="result-value" id="costOneYear">$0.00</span>
                        </div>
                    </div>
                    
                    <div class="refund-summary" id="refundSummary" style="display: none;">
                        <h3>Refund Summary</h3>
                        <div class="result-item refund">
                            <span class="result-label">Total Refund Amount:</span>
                            <span class="result-value" id="totalRefund">$0.00</span>
                        </div>
                        <div id="medicationRefundsList" class="medication-refunds-list"></div>
                    </div>
                </div>
            </div>
            
            <div id="calculationHistory" class="history-section hidden">
                <div class="history-header">
                    <h3>Recent Calculations</h3>
                    <button class="clear-history-btn" id="clearHistoryBtn">Clear History</button>
                </div>
                <div id="historyList" class="history-list"></div>
            </div>
        </div>
    </div>
    
    <div id="tooltip" class="tooltip hidden"></div>
    <div id="toast" class="toast hidden"></div>
    
    <script src="script.js"></script>
</body>
</html>
